{"remainingRequest":"D:\\project\\supermarket-jxc-sys-vue\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\project\\supermarket-jxc-sys-vue\\src\\components\\upload.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\project\\supermarket-jxc-sys-vue\\src\\components\\upload.vue","mtime":1715882558000},{"path":"D:\\project\\supermarket-jxc-sys-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1716113548707},{"path":"D:\\project\\supermarket-jxc-sys-vue\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1716113543526}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBkZWZpbmVDb21wb25lbnQsIHJlZiwgd2F0Y2ggfSBmcm9tICJ2dWUiOw0KDQpleHBvcnQgZGVmYXVsdCBkZWZpbmVDb21wb25lbnQoew0KICBuYW1lOiAiU2luZ2xlSW1hZ2VVcGxvYWQiLA0KICBwcm9wczogew0KICAgIG1vZGVsVmFsdWU6IFN0cmluZywgLy8g5o6l5pS25aSW6YOodi1tb2RlbOe7keWumueahOWAvA0KICB9LA0KICBlbWl0czogWyJ1cGRhdGU6bW9kZWxWYWx1ZSJdLCAvLyDlhYHorrjnu4Tku7bmm7TmlrB2LW1vZGVs57uR5a6a55qE5YC8DQogIHNldHVwKHByb3BzLCB7IGVtaXQgfSkgew0KICAgIGNvbnN0IGludGVybmFsSW1hZ2VVcmwgPSByZWYocHJvcHMubW9kZWxWYWx1ZSk7DQogICAgY29uc3QgdXBsb2FkVXJsID0gIi9hcGkvdGVuY2VudC9jb3MvdXBsb2FkIjsgLy8g5pu/5o2i5oiQ5L2g55qE5LiK5LygVVJMDQogICAgY29uc3QgaGVhZGVycyA9IHsNCiAgICAgIEF1dGhvcml6YXRpb246IGAke2xvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpfWAsDQogICAgfTsNCiAgICAvLyDnm5HlkKzlpJbpg6h2LW1vZGVs5Y+Y5YyW77yM5pu05paw5YaF6YOo54q25oCBDQogICAgd2F0Y2goDQogICAgICAoKSA9PiBwcm9wcy5tb2RlbFZhbHVlLA0KICAgICAgKG5ld1ZhbHVlKSA9PiB7DQogICAgICAgIGludGVybmFsSW1hZ2VVcmwudmFsdWUgPSBuZXdWYWx1ZTsNCiAgICAgIH0NCiAgICApOw0KDQogICAgLy8g5LiK5Lyg5oiQ5YqfDQogICAgY29uc3QgaGFuZGxlU3VjY2VzcyA9IChyZXNwb25zZSwgZmlsZSkgPT4gew0KICAgICAgY29uc3Qgew0KICAgICAgICBkYXRhOiB7IHVybCB9LA0KICAgICAgfSA9IHJlc3BvbnNlOw0KICAgICAgLy8g5YGH6K6+5ZCO56uv6L+U5Zue55qE5Zu+54mH5Zyw5Z2A5pivIHJlc3BvbnNlLnVybA0KICAgICAgZW1pdCgidXBkYXRlOm1vZGVsVmFsdWUiLCB1cmwpOyAvLyDnlKjkuovku7bmm7TmlrB2LW1vZGVsDQoNCiAgICAgIGludGVybmFsSW1hZ2VVcmwudmFsdWUgPSB1cmw7IC8vIOabtOaWsOe7hOS7tuWGheeahOWbvueJh+aYvuekug0KICAgIH07DQoNCiAgICAvLyDkuIrkvKDlpLHotKUNCiAgICBjb25zdCBoYW5kbGVFcnJvciA9ICgpID0+IHsNCiAgICAgIGVtaXQoInVwZGF0ZTptb2RlbFZhbHVlIiwgIiIpOyAvLyDlpoLmnpzkuIrkvKDlpLHotKXvvIzmuIXnqbp2LW1vZGVs57uR5a6a55qE5YC8DQogICAgICBpbnRlcm5hbEltYWdlVXJsLnZhbHVlID0gIiI7IC8vIOa4heepuue7hOS7tuWGheeahOWbvueJh+aYvuekug0KICAgIH07DQoNCiAgICAvLyDkuIrkvKDkuYvliY3nmoTpqozor4ENCiAgICBjb25zdCBiZWZvcmVJbWFnZVVwbG9hZCA9IChmaWxlKSA9PiB7DQogICAgICBjb25zdCBpc0pQRyA9IGZpbGUudHlwZSA9PT0gImltYWdlL2pwZWciOw0KICAgICAgY29uc3QgaXNQTkcgPSBmaWxlLnR5cGUgPT09ICJpbWFnZS9wbmciOw0KICAgICAgY29uc3QgaXNMdDJNID0gZmlsZS5zaXplIC8gMTAyNCAvIDEwMjQgPCAyOw0KDQogICAgICBpZiAoIWlzSlBHICYmICFpc1BORykgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuIrkvKDlm77niYflj6rog73mmK8gSlBHL1BORyDmoLzlvI8hIik7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICAgIGlmICghaXNMdDJNKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuS4iuS8oOWbvueJh+Wkp+Wwj+S4jeiDvei2hei/hyAyTUIhIik7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH07DQoNCiAgICByZXR1cm4gew0KICAgICAgaW50ZXJuYWxJbWFnZVVybCwNCiAgICAgIHVwbG9hZFVybCwNCiAgICAgIGhhbmRsZVN1Y2Nlc3MsDQogICAgICBoYW5kbGVFcnJvciwNCiAgICAgIGJlZm9yZUltYWdlVXBsb2FkLA0KICAgICAgaGVhZGVycywNCiAgICB9Ow0KICB9LA0KfSk7DQo="},{"version":3,"sources":["D:\\project\\supermarket-jxc-sys-vue\\src\\components\\upload.vue"],"names":[],"mappings":"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","file":"D:/project/supermarket-jxc-sys-vue/src/components/upload.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <el-upload\r\n    class=\"avatar-uploader\"\r\n    :action=\"uploadUrl\"\r\n    :show-file-list=\"false\"\r\n    :on-success=\"handleSuccess\"\r\n    :on-error=\"handleError\"\r\n    :before-upload=\"beforeImageUpload\"\r\n    :headers=\"headers\"\r\n  >\r\n    <img v-if=\"internalImageUrl\" :src=\"internalImageUrl\" class=\"avatar\" />\r\n    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n  </el-upload>\r\n</template>\r\n\r\n<script>\r\nimport { defineComponent, ref, watch } from \"vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"SingleImageUpload\",\r\n  props: {\r\n    modelValue: String, // 接收外部v-model绑定的值\r\n  },\r\n  emits: [\"update:modelValue\"], // 允许组件更新v-model绑定的值\r\n  setup(props, { emit }) {\r\n    const internalImageUrl = ref(props.modelValue);\r\n    const uploadUrl = \"/api/tencent/cos/upload\"; // 替换成你的上传URL\r\n    const headers = {\r\n      Authorization: `${localStorage.getItem(\"token\")}`,\r\n    };\r\n    // 监听外部v-model变化，更新内部状态\r\n    watch(\r\n      () => props.modelValue,\r\n      (newValue) => {\r\n        internalImageUrl.value = newValue;\r\n      }\r\n    );\r\n\r\n    // 上传成功\r\n    const handleSuccess = (response, file) => {\r\n      const {\r\n        data: { url },\r\n      } = response;\r\n      // 假设后端返回的图片地址是 response.url\r\n      emit(\"update:modelValue\", url); // 用事件更新v-model\r\n\r\n      internalImageUrl.value = url; // 更新组件内的图片显示\r\n    };\r\n\r\n    // 上传失败\r\n    const handleError = () => {\r\n      emit(\"update:modelValue\", \"\"); // 如果上传失败，清空v-model绑定的值\r\n      internalImageUrl.value = \"\"; // 清空组件内的图片显示\r\n    };\r\n\r\n    // 上传之前的验证\r\n    const beforeImageUpload = (file) => {\r\n      const isJPG = file.type === \"image/jpeg\";\r\n      const isPNG = file.type === \"image/png\";\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      if (!isJPG && !isPNG) {\r\n        this.$message.error(\"上传图片只能是 JPG/PNG 格式!\");\r\n        return false;\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error(\"上传图片大小不能超过 2MB!\");\r\n        return false;\r\n      }\r\n      return true;\r\n    };\r\n\r\n    return {\r\n      internalImageUrl,\r\n      uploadUrl,\r\n      handleSuccess,\r\n      handleError,\r\n      beforeImageUpload,\r\n      headers,\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.avatar-uploader {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 100px;\r\n  height: 100px;\r\n  line-height: 100px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 100px;\r\n  height: 100px;\r\n  display: block;\r\n}\r\n</style>"]}]}